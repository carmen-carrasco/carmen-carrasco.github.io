<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Named entity recognition with spaCy in a corpus of 19th century literature in Spanish | Carmen Carrasco Luján </title> <meta name="author" content="Carmen Carrasco Luján"> <meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. "> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/livre-ouvert.png?a43ea3ce0750023e203cd0acafc6ff93"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://carmen-carrasco.github.io/projects/spaCy/"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?0afe9f0ae161375728f7bcc5eb5b4ab4"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Carmen </span> Carrasco Luján </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/portfolio/">portfolio </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">submenus </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/publications/">publications</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/projects/">projects</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/blog/">blog</a> </div> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Named entity recognition with spaCy in a corpus of 19th century literature in Spanish</h1> <p class="post-description"></p> </header> <article> <p>One of the objectives of my project (<a href="https://carmen-carrasco.github.io/projects/SF_Peru_Argentina/">a library of speculative fiction literature from the 19th century from Peru and Argentina</a>) is to analyze the literary works using the tools of Natural Language Processing (NLP) and computational linguistics.</p> <p>One of the analyses we present here involves geoparsing. This means that we will analyze which places in the future world are mentioned in our 19th-century texts, and then organize them into geographic coordinates and maps.</p> <p>This process is developed in different stages, which can be summarized in three:</p> <p>I. Named Entities Recognition: Places</p> <p>II. Georeferencing of the corpus</p> <p>III. Development of the cartographies</p> <p>Here, only the first stage consisting of the recognition of named entities will be presented. All this stage was carried out using Python through Jupyter lab.</p> <p>Firstly, we start with raw text after OCRization, which is not clean as many words are split across lines.</p> <pre><code class="language-txt">5559 — Imprenta del "Porvenir,” calle Defensa 139.
AL SEÑOR DON ANTONINO CAMBACERES
PRESIDENTE DE LA ADMINISTRACION DEL FERRO-CARRIL DEL OESTE
Señor:
Este librito, en el que, á la manera de Julio
Verne, de Mery y del autor anónimo de la ba¬
talla de Dorking, se hace un bosquejo del Por¬
venir que espera á vuestra República, no podía
ménos que dedicarse á un gran Administrador,
á un Político prudente, honrado y liberal; en
fin, á un amante apasionado del Progreso bajo
todas sus formas.
Hé ahí, en verdad, las cualidades que habrán
de sobresalir en vuestros hombres de Estado, si
desean asegurar para la Patria Argentina la
prosperidad que, sin temor de equavocarme, se la
puede augurar, y que yo le deseo con todo mi
corazon.
¿Quién, sinó vos, podría ser más acreedor á
mi preferencia, Señor? Este librito podrá ele¬
varse hasta los astros, si os dignais aceptar su
dedicatoria, si el público le concede una pequeña
parte de la merecida popularidad y de la alta
consideracion con que os rodea.
Dignaos admitir, Señor, con la seguridad
de mi gratitud, la de mi profunda considera¬
cion.
Buenos Aires, Julio 23 de 1879.
SEÑOR DON AQUILES SIOEN:
Presente.
Distinguido Señor:
Carezco absolutamente de los méritos que V.
tiene la bondad de atribuirme. Acepto, no obs-
tante, gustoso, la dedicatoria de su libro, pero
sólo como una prueba de la benevolencia que V.
me manifiesta.
[...]
</code></pre> <p>That’s why, to clean the text, we need to remove unnecessary line breaks and join split words, then save the result into a new document. For this, I used the following code:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Read the file
</span><span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="sh">'</span><span class="s">doc.txt</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">r</span><span class="sh">'</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="sh">'</span><span class="s">utf-8</span><span class="sh">'</span><span class="p">)</span> <span class="k">as</span> <span class="nb">file</span><span class="p">:</span>
    <span class="n">text</span> <span class="o">=</span> <span class="nb">file</span><span class="p">.</span><span class="nf">readlines</span><span class="p">()</span>

<span class="c1"># Remove unnecessary line breaks and join split words
</span><span class="n">text_modified</span> <span class="o">=</span> <span class="sh">""</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">texto</span><span class="p">:</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="p">.</span><span class="nf">strip</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">line</span><span class="p">.</span><span class="nf">endswith</span><span class="p">(</span><span class="sh">"</span><span class="s">¬</span><span class="sh">"</span><span class="p">):</span>
        <span class="n">text_modified</span> <span class="o">+=</span> <span class="n">line</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">text_modified</span> <span class="o">+=</span> <span class="n">line</span> <span class="o">+</span> <span class="sh">"</span><span class="s"> </span><span class="sh">"</span>

<span class="c1"># Write the modified text back to the file
</span><span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="sh">'</span><span class="s">doc_modified.txt</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">w</span><span class="sh">'</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="sh">'</span><span class="s">utf-8</span><span class="sh">'</span><span class="p">)</span> <span class="k">as</span> <span class="nb">file</span><span class="p">:</span>
    <span class="nb">file</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="n">text_modified</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Process completed. The modified text has been saved in </span><span class="sh">'</span><span class="s">doc_modified.txt</span><span class="sh">'</span><span class="s">.</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div> <p>The result is a clean text like the following:</p> <pre><code class="language-txt">5559 — Imprenta del "Porvenir,” calle Defensa 139. AL SEÑOR DON ANTONINO CAMBACERES PRESIDENTE DE LA ADMINISTRACION DEL FERRO-CARRIL DEL OESTE Señor: Este librito, en el que, á la manera de Julio Verne, de Mery y del autor anónimo de la batalla de Dorking, se hace un bosquejo del Porvenir que espera á vuestra República, no podía ménos que dedicarse á un gran Administrador, á un Político prudente, honrado y liberal; en fin, á un amante apasionado del Progreso bajo todas sus formas. Hé ahí, en verdad, las cualidades que habrán de sobresalir en vuestros hombres de Estado, si desean asegurar para la Patria Argentina la prosperidad que, sin temor de equavocarme, se la puede augurar, y que yo le deseo con todo mi corazon. ¿Quién, sinó vos, podría ser más acreedor á mi preferencia, Señor? Este librito podrá elevarse hasta los astros, si os dignais aceptar su dedicatoria, si el público le concede una pequeña parte de la merecida popularidad y de la alta consideracion con que os rodea. Dignaos admitir, Señor, con la seguridad de mi gratitud, la de mi profunda consideracion. Buenos Aires, Julio 23 de 1879. SEÑOR DON AQUILES SIOEN: Presente. Distinguido Señor: Carezco absolutamente de los méritos que V. tiene la bondad de atribuirme. Acepto, no obstante, gustoso, la dedicatoria de su libro, pero sólo como una prueba de la benevolencia que V. me manifiesta. [...]]
</code></pre> <p>The next step is to install the spaCy package.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Now we can use Spacy to get the places' names
</span>
<span class="kn">import</span> <span class="n">spacy</span>

<span class="c1"># Load the Spanish language model
</span><span class="n">nlp</span> <span class="o">=</span> <span class="n">spacy</span><span class="p">.</span><span class="nf">load</span><span class="p">(</span><span class="sh">"</span><span class="s">es_core_news_sm</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div> <p>Now we can extract the names of places from our document using spaCy:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c1"># Read the clean text from the file
</span><span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="sh">'</span><span class="s">doc_modified.txt</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">r</span><span class="sh">'</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="sh">'</span><span class="s">utf-8</span><span class="sh">'</span><span class="p">)</span> <span class="k">as</span> <span class="nb">file</span><span class="p">:</span>
    <span class="n">text</span> <span class="o">=</span> <span class="nb">file</span><span class="p">.</span><span class="nf">read</span><span class="p">()</span>

<span class="c1"># Process the text with SpaCy
</span><span class="n">doc</span> <span class="o">=</span> <span class="nf">nlp</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

<span class="c1"># Extract all named entities of type "LOC" (location)
</span><span class="n">locations</span> <span class="o">=</span> <span class="p">[</span><span class="n">ent</span><span class="p">.</span><span class="n">text</span> <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">.</span><span class="n">ents</span> <span class="k">if</span> <span class="n">ent</span><span class="p">.</span><span class="n">label_</span> <span class="o">==</span> <span class="sh">'</span><span class="s">LOC</span><span class="sh">'</span><span class="p">]</span>

<span class="c1"># Print the recognized location names
</span><span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Recognized location names:</span><span class="sh">"</span><span class="p">)</span>
<span class="k">for</span> <span class="n">location</span> <span class="ow">in</span> <span class="n">locations</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>
</code></pre></div></div> <p>The result is as follows:</p> <pre><code class="language-txt">Recognized location names:
Porvenir
á
Porvenir
Administrador
á
Progreso
Dignaos
Buenos Aires
Julio
Acepto
Buenos Aires
BUENOS AIRES
¡Ay
BUENOS AIRES
á
BUENOS AIRES
mañana
Provincia de Coluguape
Patagonia Central
Buenos Aires
la Rioja
Provincia
San Cristobal
Coluguape
Carancho
Buenos Aires
Americana
Argentina
Estrecho de Magallanes á Rio-Janeiro
Buenos Aires
Asuncion
[...]
</code></pre> <p>As you can observe, spaCy recognizes some words as places due to syntax, even though they are not truly places. Therefore, we will have to move on to the next stage, which involves machine learning to train the computer to recognize places, minimizing errors as much as possible.</p> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2024 Carmen Carrasco Luján. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2930004b8d7fcd0a8e00fdcfc8fc9f24"></script> <script defer src="/assets/js/common.js?4a129fbf39254905f505c7246e641eaf"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>
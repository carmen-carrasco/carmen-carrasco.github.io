<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd"> <html><body> <p>The objective of this post is to perform a sentiment analysis on the novel “Buenos Aires en el año 2080 (1879)” by Aquiles Sioen, using the R package called <code class="language-plaintext highlighter-rouge">syuzhet</code>, developed by Matthew Jockers.</p> <h2 id="sentiment-analysis">Sentiment analysis</h2> <p>Sentiment analysis is an umbrella term used to describe a wide range of automated processes aimed at determining the degree of positivity or negativity of sentiments in a given text. There are numerous algorithms available in various programming languages. Additionally, there are various lexicons in multiple languages with terms associated with different sentiments.</p> <p>Sentiment analysis has been used in various contexts such as politics or marketing. In literary studies, this technique has been met with some skepticism because it is difficult to attribute feelings to a subjective text. Furthermore, lexicons have been developed in English, and some of the versions available in other languages (such as Spanish in this case) are literal translations from English.</p> <h2 id="analysis-of-buenos-aires-en-el-año-2080">Analysis of ‘Buenos Aires en el año 2080’</h2> <p>The first step is installing the necessary packages for our analysis. In addition to the <code class="language-plaintext highlighter-rouge">syuzhet</code> package, we will install:</p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Install the Packages</span><span class="w">
</span><span class="n">install.packages</span><span class="p">(</span><span class="s2">"syuzhet"</span><span class="p">)</span><span class="w">
</span><span class="n">install.packages</span><span class="p">(</span><span class="s2">"RColorBrewer"</span><span class="p">)</span><span class="w">
</span><span class="n">install.packages</span><span class="p">(</span><span class="s2">"wordcloud"</span><span class="p">)</span><span class="w">
</span><span class="n">install.packages</span><span class="p">(</span><span class="s2">"tm"</span><span class="p">)</span><span class="w">

</span><span class="c1"># Load the Packages</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">syuzhet</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">RColorBrewer</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">wordcloud</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">tm</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <p>Next, since we have already cleaned the text in TXT format in a <a href="https://carmen-carrasco.github.io/projects/spaCy/">previous post</a>, we have it like this:</p> <pre><code class="language-txt">5559 — Imprenta del "Porvenir,” calle Defensa 139. AL SEÑOR DON ANTONINO CAMBACERES PRESIDENTE DE LA ADMINISTRACION DEL FERRO-CARRIL DEL OESTE Señor: Este librito, en el que, á la manera de Julio Verne, de Mery y del autor anónimo de la batalla de Dorking, se hace un bosquejo del Porvenir que espera á vuestra República, no podía ménos que dedicarse á un gran Administrador, á un Político prudente, honrado y liberal; en fin, á un amante apasionado del Progreso bajo todas sus formas. Hé ahí, en verdad, las cualidades que habrán de sobresalir en vuestros hombres de Estado, si desean asegurar para la Patria Argentina la prosperidad que, sin temor de equavocarme, se la puede augurar, y que yo le deseo con todo mi corazon. ¿Quién, sinó vos, podría ser más acreedor á mi preferencia, Señor? Este librito podrá elevarse hasta los astros, si os dignais aceptar su dedicatoria, si el público le concede una pequeña parte de la merecida popularidad y de la alta consideracion con que os rodea. Dignaos admitir, Señor, con la seguridad de mi gratitud, la de mi profunda consideracion. Buenos Aires, Julio 23 de 1879. SEÑOR DON AQUILES SIOEN: Presente. Distinguido Señor: Carezco absolutamente de los méritos que V. tiene la bondad de atribuirme. Acepto, no obstante, gustoso, la dedicatoria de su libro, pero sólo como una prueba de la benevolencia que V. me manifiesta. [...]
</code></pre> <p>Now we need to convert it into a string to analyze it in R. To do this, we need to open it with a filepath:</p> <p>In Windows, you can convert it into a string using the path:</p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">text_string</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">scan</span><span class="p">(</span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"FILEPATH"</span><span class="p">,</span><span class="w"> </span><span class="n">fileEncoding</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"UTF-8"</span><span class="p">,</span><span class="w"> </span><span class="n">what</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">character</span><span class="p">(),</span><span class="w"> </span><span class="n">sep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"\n"</span><span class="p">,</span><span class="w"> </span><span class="n">allowEscapes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">T</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <p>In this case, it would be:</p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">text_string</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">scan</span><span class="p">(</span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"C:\\Users\\Carmen\\Desktop\\doc_modified.txt"</span><span class="p">,</span><span class="w"> </span><span class="n">fileEncoding</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"UTF-8"</span><span class="p">,</span><span class="w"> </span><span class="n">what</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">character</span><span class="p">(),</span><span class="w"> </span><span class="n">sep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"\n"</span><span class="p">,</span><span class="w"> </span><span class="n">allowEscapes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">T</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <h3 id="getting-tokens">Getting tokens</h3> <p>To analyze the text with the algorithm, it needs to be in a format recognizable by it, which means tokens, in this case, will be words.</p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">text_words</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">get_tokens</span><span class="p">(</span><span class="n">text_string</span><span class="p">)</span><span class="w">
</span><span class="n">head</span><span class="p">(</span><span class="n">text_words</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <p>Resulting in:</p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="s2">"5559"</span><span class="w">     </span><span class="s2">"imprenta"</span><span class="w"> </span><span class="s2">"del"</span><span class="w">      </span><span class="s2">"porvenir"</span><span class="w"> </span><span class="s2">"calle"</span><span class="w">    </span><span class="s2">"defensa"</span><span class="w"> 
</span></code></pre></div></div> <p>Now that we have the tokenized text, we can use the <code class="language-plaintext highlighter-rouge">get_nrc_sentiment</code> function to obtain the sentiment score for each word in the text.</p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sentiment_scores</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">get_nrc_sentiment</span><span class="p">(</span><span class="n">text_words</span><span class="p">,</span><span class="w"> </span><span class="n">lang</span><span class="o">=</span><span class="s2">"spanish"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <p>The results are automatically saved in a CSV file. To observe the beginning of the result, we can write: <code class="language-plaintext highlighter-rouge">head(sentiment_scores)</code>, and it will display:</p> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/head_buenosAires-480.webp 480w,/assets/img/head_buenosAires-800.webp 800w,/assets/img/head_buenosAires-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/head_buenosAires.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Head sentiment scores" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>Next, we can obtain a chart by emotion to interpret our results:</p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">barplot</span><span class="p">(</span><span class="w">
  </span><span class="n">colSums</span><span class="p">(</span><span class="n">prop.table</span><span class="p">(</span><span class="n">sentiment_scores</span><span class="p">[,</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">8</span><span class="p">])),</span><span class="w">
  </span><span class="n">space</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.2</span><span class="p">,</span><span class="w">
  </span><span class="n">horiz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w">
  </span><span class="n">las</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w">
  </span><span class="n">cex.names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.7</span><span class="p">,</span><span class="w">
  </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">brewer.pal</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">8</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Set3"</span><span class="p">),</span><span class="w">
  </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"'Buenos Aires en el año 2080' by Aquiles Sioen, 1879 edition"</span><span class="p">,</span><span class="w">
  </span><span class="n">sub</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Analysis by Carmen Carrasco"</span><span class="p">,</span><span class="w">
  </span><span class="n">xlab</span><span class="o">=</span><span class="s2">"emotions"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <p>The result is:</p> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/BuenosAiresChart-480.webp 480w,/assets/img/BuenosAiresChart-800.webp 800w,/assets/img/BuenosAiresChart-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/BuenosAiresChart.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Chart by Emotion" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <h2 id="emotions-cloud">Emotions Cloud</h2> <p>To obtain an emotion cloud, first, we collect all the words with an emotion score greater than 0.</p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">cloud_emotions_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="w">
  </span><span class="n">paste</span><span class="p">(</span><span class="n">text_words</span><span class="p">[</span><span class="n">sentiment_scores</span><span class="o">$</span><span class="n">sadness</span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="p">],</span><span class="w"> </span><span class="n">collapse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">" "</span><span class="p">),</span><span class="w">
  </span><span class="n">paste</span><span class="p">(</span><span class="n">text_words</span><span class="p">[</span><span class="n">sentiment_scores</span><span class="o">$</span><span class="n">joy</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="p">],</span><span class="w"> </span><span class="n">collapse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">" "</span><span class="p">),</span><span class="w">
  </span><span class="n">paste</span><span class="p">(</span><span class="n">text_words</span><span class="p">[</span><span class="n">sentiment_scores</span><span class="o">$</span><span class="n">anger</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="p">],</span><span class="w"> </span><span class="n">collapse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">" "</span><span class="p">),</span><span class="w">
  </span><span class="n">paste</span><span class="p">(</span><span class="n">text_words</span><span class="p">[</span><span class="n">sentiment_scores</span><span class="o">$</span><span class="n">fear</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="p">],</span><span class="w"> </span><span class="n">collapse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">" "</span><span class="p">))</span><span class="w">

</span><span class="n">cloud_emotions_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">iconv</span><span class="p">(</span><span class="n">cloud_emotions_data</span><span class="p">,</span><span class="w"> </span><span class="s2">"latin1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"UTF-8"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <p>And we save it in <code class="language-plaintext highlighter-rouge">cloud_corpus &lt;- Corpus(VectorSource(cloud_emotions_data))</code>. Next, we can create the emotion cloud.</p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">set.seed</span><span class="p">(</span><span class="m">750</span><span class="p">)</span><span class="w"> 
</span><span class="n">comparison.cloud</span><span class="p">(</span><span class="n">cloud_tdm</span><span class="p">,</span><span class="w"> </span><span class="n">random.order</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w">
                 </span><span class="n">colors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"green"</span><span class="p">,</span><span class="w"> </span><span class="s2">"red"</span><span class="p">,</span><span class="w"> </span><span class="s2">"orange"</span><span class="p">,</span><span class="w"> </span><span class="s2">"blue"</span><span class="p">),</span><span class="w">
                 </span><span class="n">title.size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">max.words</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">50</span><span class="p">,</span><span class="w"> </span><span class="n">scale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">2.5</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">rot.per</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.4</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <p>The result is as follows:</p> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/Cloud_BuenosAires-480.webp 480w,/assets/img/Cloud_BuenosAires-800.webp 800w,/assets/img/Cloud_BuenosAires-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/Cloud_BuenosAires.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Chart by Emotion" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </body></html>